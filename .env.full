# ============================================================================
# üèõÔ∏è ALGORITHMIC TRADING SYSTEM - COMPREHENSIVE CONFIGURATION
# ============================================================================
# This is the master environment configuration file for the trading system.
# All settings have been consolidated from multiple env files with descriptions.
# Adjust values based on your environment: development, testing, or production.
#
# üìã Configuration Sections:
#   1. üîê Security & Authentication
#   2. üåê Application & Server Settings  
#   3. üìà IIFL API Configuration
#   4. üí∞ Trading & Risk Management
#   5. üìä Logging & Monitoring
#   6. üïê Scheduler Configuration
#   7. ü§ñ Telegram Notifications
#   8. üóÑÔ∏è Database Configuration
#   9. üìß Email & Alerting
#   10. üîÑ Backup & Performance
# ============================================================================

# ============================================================================
# üîê SECURITY & AUTHENTICATION
# ============================================================================

# Main secret key for session management and JWT tokens
# üîí PRODUCTION: Cryptographically secure keys generated on Oct 13, 2025
SECRET_KEY=i1BtEXaGEyjrPns4BgK7rryTbWHR1mX90hZC0dmvpeQ

# API secret key for endpoint authentication  
API_SECRET_KEY=sk2uA0cLjm5xSR2aydxoFsye7NtFO6Py3XVqbwDoEYo

# JWT secret key for token signing
JWT_SECRET_KEY=fZYFQHfFZRKRoFRVEcjB58a_6YYJ2FNlrbT_4brq9eY

# Encryption key for sensitive data
ENCRYPTION_KEY=wH5PWWwNDhvwts3pMwuFeVrB4g-Ng5uC5-d2ah-y96k

# Access token expiration time (minutes)
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Environment: development, testing, production
ENVIRONMENT=production

# ============================================================================
# üåê APPLICATION & SERVER SETTINGS
# ============================================================================

# Server host and port configuration
HOST=0.0.0.0
PORT=8000

# Debug mode (NEVER enable in production)
DEBUG=false

# Hot reload for development (disable in production)
RELOAD=false

# Enable dry run mode (no actual trades, only simulation)
# üö® PRODUCTION WARNING: Set to false ONLY when ready for live trading
DRY_RUN=false

# ============================================================================
# üìà IIFL API CONFIGURATION
# ============================================================================

# IIFL client credentials
# üîó Get these from your IIFL Capital account dashboard
IIFL_CLIENT_ID=MKKIRAN9
IIFL_AUTH_CODE=N49IQQZCRVCQQ6HL9VEX
IIFL_APP_SECRET=hHOq5jEHMoBdFLclNnWEgK4wFV4IzKZSbHwDQn37T0VUepQn0P3odbwKQEmkYIraoTVcLeL56JLIfMhXKxb65EKUzmb6hAlzyTfI

# IIFL API endpoints
IIFL_BASE_URL=https://api.iiflcapital.com/v1
IIFL_API_BASE_URL=https://ttblaze.iifl.com/apimarketdata

# ============================================================================
# üí∞ TRADING & RISK MANAGEMENT
# ============================================================================

# üö¶ MASTER TRADING CONTROLS
# üö® PRODUCTION WARNING: Set to true ONLY when ready for live trading
AUTO_TRADE=false                        # Enable/disable automatic trading
SIGNAL_TIMEOUT=300                      # Signal validity timeout (seconds)

# üìä RISK MANAGEMENT (Optimized based on backtest analysis)
RISK_PER_TRADE=0.025                    # 2.5% risk per trade (up from 2% based on 1.88:1 R/R)
MAX_POSITIONS=12                        # Maximum concurrent positions (up from 10)
MAX_DAILY_LOSS=0.06                     # 6% maximum daily loss limit
MAX_POSITION_SIZE=100000                # Maximum position size in currency
MAX_POSITIONS_PER_DAY=20                # Daily position limit

# üéØ POSITION SIZING & EXITS
POSITION_SIZE_PERCENT=0.02              # 2% of portfolio per position
STOP_LOSS_PERCENT=0.02                  # 2% stop loss
TAKE_PROFIT_PERCENT=0.04                # 4% take profit target

# üîç QUALITY FILTERS (Based on backtest optimization)
MIN_PRICE=50.0                          # Minimum stock price (up from 10.0 for quality)
MIN_LIQUIDITY=200000                    # Minimum daily volume (up from 100K)
MIN_CONFIDENCE_THRESHOLD=0.65           # Minimum signal confidence (65%)

# üìà TECHNICAL ANALYSIS THRESHOLDS
VOLUME_CONFIRMATION_MULTIPLIER=0.8      # Volume confirmation multiplier
MOMENTUM_THRESHOLD=0.015                # 1.5% momentum requirement
TREND_STRENGTH_MULTIPLIER=1.2           # EMA separation requirement
REQUIRE_TREND_CONFIRMATION=true         # Must be above EMA50 for buy signals

# üè≠ SECTOR DIVERSIFICATION (New feature)
MAX_SECTOR_EXPOSURE=0.30                # Maximum 30% exposure per sector
ENABLE_SECTOR_DIVERSIFICATION=true      # Enable automatic sector diversification

# üìã PRODUCT TYPES
DEFAULT_BUY_PRODUCT=NORMAL              # Product type for long positions
DEFAULT_SELL_PRODUCT=NORMAL             # Product type for closing longs
SHORT_SELL_PRODUCT=INTRADAY            # Product type for short positions
DAY_TRADING_PRODUCT=INTRADAY           # Product type for day trading

# üîÑ ADVANCED TRADING FEATURES
ALLOW_SHORT_SELLING=true                # Enable short selling capability
PRICE_QUALITY_FILTER=true              # Filter choppy/low-quality price action

# ============================================================================
# üìä LOGGING & MONITORING CONFIGURATION
# ============================================================================

# üéõÔ∏è BASIC LOGGING SETTINGS (PRODUCTION OPTIMIZED)
LOG_LEVEL=INFO                          # Overall log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_FILE=logs/trading_system.log        # Main log file location
LOG_CONSOLE_ENABLED=false               # Enable console output (disable in production)
LOG_FILE_ENABLED=true                   # Enable file logging
LOG_JSON_FORMAT=true                    # Use structured JSON logging

# üìÅ LOG ROTATION & RETENTION
LOG_MAX_BYTES=52428800                  # 50MB max file size before rotation
LOG_BACKUP_COUNT=10                     # Keep 10 backup files
LOG_RETENTION_DAYS=30                   # Keep logs for 30 days
LOG_ROTATION_TIME=86400                 # Rotate daily (24 hours in seconds)

# üéØ COMPONENT-SPECIFIC LOG LEVELS
LOG_LEVEL_TRADING=INFO                  # Trading operations
LOG_LEVEL_RISK=WARNING                  # Risk management
LOG_LEVEL_ORDERS=INFO                   # Order management
LOG_LEVEL_SIGNALS=INFO                  # Signal generation
LOG_LEVEL_SCHEDULER=WARNING             # Scheduler operations
LOG_LEVEL_API=WARNING                   # API calls (can be noisy)
LOG_LEVEL_DATABASE=ERROR                # Database operations
LOG_LEVEL_MARKET_DATA=WARNING           # Market data fetching
LOG_LEVEL_BACKTEST=ERROR                # Backtesting operations
LOG_LEVEL_TELEGRAM=WARNING              # Telegram notifications

# ‚ö° PERFORMANCE LOGGING
LOG_PERFORMANCE_THRESHOLD=1000          # Log operations slower than 1000ms
ENABLE_PERFORMANCE_LOGGING=true         # Enable performance monitoring
LOG_SLOW_QUERIES=true                   # Log slow database queries
SLOW_QUERY_THRESHOLD_MS=500             # Slow query threshold

# üîÑ LOG OPTIMIZATION (Production features)
LOG_RATE_LIMIT_ENABLED=true             # Enable log rate limiting
LOG_RATE_LIMIT_MESSAGES=60              # Max 60 messages per window
LOG_RATE_LIMIT_WINDOW=60                # 60-second rate limit window
LOG_ERROR_AGGREGATION_ENABLED=true      # Aggregate duplicate errors
LOG_ERROR_AGGREGATION_WINDOW=300        # 5-minute aggregation window
LOG_SAMPLING_ENABLED=true               # Enable log sampling (use in high-freq)
LOG_SAMPLING_RATE=0.8                   # Sample 80% of logs in production

# üö® CRITICAL EVENTS LOGGING
ENABLE_CRITICAL_EVENTS=true             # Enable critical events tracking
CRITICAL_EVENTS_IMMEDIATE_FLUSH=true    # Immediately flush critical events
CRITICAL_EVENTS_MAX_SIZE_MB=50          # Max size for critical events log

# ============================================================================
# üïê SCHEDULER CONFIGURATION
# ============================================================================

# üéõÔ∏è MASTER SCHEDULER CONTROLS (PRODUCTION READY)
ENABLE_SCHEDULER=true                   # Master scheduler enable/disable
SCHEDULER_ENABLED=true                  # Alternative scheduler flag

# üìã STRATEGY-SPECIFIC SCHEDULERS
ENABLE_DAY_TRADING_SCHEDULER=true       # Day trading strategy
ENABLE_SHORT_SELLING_SCHEDULER=true     # Short selling strategy  
ENABLE_SHORT_TERM_SCHEDULER=true        # Short-term swing trading
ENABLE_LONG_TERM_SCHEDULER=true         # Long-term investment strategy

# ‚è∞ EXECUTION FREQUENCIES (minutes)
DAY_TRADING_FREQUENCY=5                 # Every 5 minutes (high-frequency)
SHORT_SELLING_FREQUENCY=30              # Every 30 minutes
SHORT_TERM_FREQUENCY=120                # Every 2 hours
LONG_TERM_FREQUENCY=1440                # Daily (1440 minutes)

# üìÖ GENERAL INTERVALS
SIGNAL_GENERATION_INTERVAL=300          # 5 minutes signal generation
RISK_CHECK_INTERVAL=60                  # 1 minute risk checks
PORTFOLIO_UPDATE_INTERVAL=120           # 2 minutes portfolio updates
LOG_CLEANUP_INTERVAL=86400              # Daily log cleanup

# üè™ MARKET HOURS (IST - Indian Standard Time)
MARKET_OPEN_TIME=09:15                  # Market opening time
MARKET_CLOSE_TIME=15:30                 # Market closing time
MARKET_START_HOUR=9                     # Market start hour
MARKET_START_MINUTE=15                  # Market start minute
MARKET_END_HOUR=15                      # Market end hour
MARKET_END_MINUTE=30                    # Market end minute
TIMEZONE=Asia/Kolkata                   # Timezone setting

# üåÖ EXTENDED HOURS ANALYSIS
ENABLE_PRE_MARKET_ANALYSIS=true         # 8:00 AM - 9:15 AM analysis
ENABLE_POST_MARKET_ANALYSIS=true        # 3:30 PM - 6:00 PM analysis

# ‚öôÔ∏è RESOURCE MANAGEMENT
MAX_CONCURRENT_STRATEGIES=3             # Max parallel strategies
STRATEGY_TIMEOUT_MINUTES=15             # Strategy execution timeout

# ============================================================================
# ü§ñ TELEGRAM NOTIFICATIONS
# ============================================================================

# üì± TELEGRAM BOT CONFIGURATION (PRODUCTION ENABLED)
TELEGRAM_BOT_TOKEN=8231093244:AAEC4uLXUhx1SJylPV-bYYp5PrM2Eo_ShfA
TELEGRAM_CHAT_ID=8062626973
TELEGRAM_BOT_ENABLED=true               # Enable/disable bot
TELEGRAM_NOTIFICATIONS_ENABLED=true     # Enable notifications
TELEGRAM_BACKGROUND_TASKS_ENABLED=true  # Enable background tasks

# üîî NOTIFICATION TYPES
TELEGRAM_ERROR_NOTIFICATIONS=true       # Error notifications
TELEGRAM_TRADE_NOTIFICATIONS=true       # Trade execution notifications

# ============================================================================
# üóÑÔ∏è DATABASE CONFIGURATION
# ============================================================================

# üíæ DATABASE CONNECTION
DATABASE_URL=sqlite+aiosqlite:///./trading_system.db

# üîÑ CONNECTION POOL SETTINGS (for production databases)
DB_POOL_SIZE=20                         # Connection pool size
DB_MAX_OVERFLOW=10                      # Max overflow connections
DB_POOL_RECYCLE=3600                    # Recycle connections every hour

# üìä MARKET DATA CACHING
MARKET_DATA_CACHE_TTL=300               # 5 minutes cache TTL
HISTORICAL_DATA_CACHE_TTL=3600          # 1 hour historical data cache
MAX_SYMBOLS_PER_REQUEST=50              # Max symbols per API request

# ============================================================================
# üìß EMAIL & ALERTING CONFIGURATION
# ============================================================================

# üìß EMAIL SETTINGS (Optional)
EMAIL_ENABLED=false                     # Enable email notifications
SMTP_SERVER=smtp.gmail.com              # SMTP server
SMTP_PORT=587                           # SMTP port
SMTP_USERNAME=your_email@gmail.com      # Email username
SMTP_PASSWORD=your_app_password_here    # App-specific password
EMAIL_FROM=your_email@gmail.com         # From email address
EMAIL_TO=admin@yourdomain.com           # Alert recipient

# üîî ERROR TRACKING & MONITORING
SENTRY_DSN=your_sentry_dsn_here         # Sentry error tracking DSN
SENTRY_ENVIRONMENT=production           # Sentry environment
SENTRY_TRACES_SAMPLE_RATE=0.1           # Sentry performance monitoring rate

# üìà PERFORMANCE MONITORING
PERFORMANCE_MONITORING_ENABLED=true     # Enable performance monitoring
METRICS_COLLECTION_ENABLED=true         # Enable metrics collection
HEALTH_CHECK_INTERVAL=30                # Health check interval (seconds)

# üîç MONITORING ENDPOINTS
HEALTH_CHECK_URL=http://localhost:8000/health
METRICS_URL=http://localhost:8000/metrics

# ============================================================================
# üîÑ BACKUP & SYSTEM CONFIGURATION
# ============================================================================

# üíæ BACKUP SETTINGS
BACKUP_ENABLED=true                     # Enable automated backups
BACKUP_INTERVAL=86400                   # Daily backup interval (seconds)
BACKUP_RETENTION_DAYS=30                # Keep backups for 30 days
BACKUP_LOCATION=./backups               # Backup directory

# üîê SECURITY SETTINGS
ALLOWED_ORIGINS=https://yourdomain.com,https://trading.yourdomain.com
CORS_ALLOW_CREDENTIALS=true             # Allow credentials in CORS
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE  # Allowed HTTP methods
CORS_MAX_AGE=3600                       # CORS preflight cache time

# üö¶ RATE LIMITING
RATE_LIMIT_ENABLED=true                 # Enable rate limiting
RATE_LIMIT_AUTH_REQUESTS=5              # 5 auth requests per window
RATE_LIMIT_AUTH_WINDOW=60               # 60-second auth window
RATE_LIMIT_API_REQUESTS=100             # 100 API requests per window
RATE_LIMIT_API_WINDOW=60                # 60-second API window
RATE_LIMIT_ORDERS_REQUESTS=60           # 60 order requests per window
RATE_LIMIT_ORDERS_WINDOW=60             # 60-second orders window

# üîí SESSION SECURITY (PRODUCTION HARDENED)
SESSION_MAX_AGE=1800                    # 30 minutes session timeout
SESSION_SAME_SITE=strict                # Strict same-site policy
SESSION_HTTPS_ONLY=true                 # HTTPS only (enable in production)

# üê≥ CONTAINER CONFIGURATION
CONTAINER_MEMORY_LIMIT=1g               # Docker memory limit
CONTAINER_CPU_LIMIT=1.0                 # Docker CPU limit

# üìÅ FILE SYSTEM SECURITY
UMASK=022                               # File creation permissions
FILE_PERMISSIONS_STRICT=true            # Enforce strict file permissions

# üõ°Ô∏è SECURITY HEADERS
SECURITY_HEADERS_ENABLED=true           # Enable security headers
HSTS_MAX_AGE=31536000                   # HTTP Strict Transport Security
CONTENT_SECURITY_POLICY=default-src 'self'  # Content Security Policy
X_FRAME_OPTIONS=DENY                    # X-Frame-Options header
X_CONTENT_TYPE_OPTIONS=nosniff          # X-Content-Type-Options header

# üîç SYSTEM MONITORING (PRODUCTION ENABLED)
ENABLE_SYSTEM_STATUS_CHECKS=true        # Enable system health checks

# ============================================================================
# üéõÔ∏è ENVIRONMENT-SPECIFIC RECOMMENDATIONS
# ============================================================================

# üß™ DEVELOPMENT ENVIRONMENT:
# - Set LOG_LEVEL=DEBUG for detailed debugging
# - Enable LOG_CONSOLE_ENABLED=true
# - Set DRY_RUN=true for safety
# - Use ENVIRONMENT=development
# - Set AUTO_TRADE=false

# üß™ TESTING ENVIRONMENT:  
# - Set LOG_LEVEL=INFO
# - Enable detailed logging for validation
# - Use smaller position sizes for testing
# - Set CRITICAL_EVENTS_IMMEDIATE_FLUSH=false

# üè≠ PRODUCTION ENVIRONMENT:
# - Set LOG_LEVEL=INFO or WARNING
# - Set LOG_CONSOLE_ENABLED=false
# - Enable LOG_SAMPLING for high frequency
# - Set CRITICAL_EVENTS_IMMEDIATE_FLUSH=true
# - Use proper SSL certificates
# - Set SESSION_HTTPS_ONLY=true
# - Generate new SECRET_KEY and API_SECRET_KEY

# üöÄ HIGH-FREQUENCY TRADING:
# - Enable LOG_SAMPLING=true with low sample rate
# - Set API_LOG_RATE_LIMIT=50 or lower
# - Reduce PERFORMANCE_THRESHOLD_MS=100
# - Set LOG_LEVEL_API=ERROR
# - Minimize logging to critical events only

# ============================================================================
# üìã USAGE NOTES
# ============================================================================

# üîê Security: Always generate new keys for production
# üìä Monitoring: Configure Sentry and Telegram for alerts  
# üíæ Backups: Ensure backup location has sufficient space
# üîÑ Optimization: Tune logging and cache settings based on usage
# üìà Trading: Start with paper trading (DRY_RUN=true) before live trading
# ‚ö° Performance: Monitor system resources and adjust concurrency limits

# ============================================================================

